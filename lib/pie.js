// Generated by CoffeeScript 1.10.0
var PieChart, React, d3;

React = require('react');

d3 = require('d3');

module.exports = PieChart = React.createClass({displayName: "PieChart",
  getDefaultProps: function() {
    return {
      color: '#000',
      inner_radius: 0
    };
  },
  render: function() {
    var arc, arcs, color, data, height, hover, inner_radius, onClick, onHover, pie, radius, ref, selected, width;
    ref = this.props, width = ref.width, height = ref.height, data = ref.data, onClick = ref.onClick, onHover = ref.onHover, selected = ref.selected, hover = ref.hover, inner_radius = ref.inner_radius;
    radius = Math.min(width, height) / 2;
    color = d3.scaleOrdinal(d3.schemeCategory20);
    pie = d3.pie().value(function(d) {
      return d.count;
    }).sort(null);
    if (this.props.start_angle) {
      pie = pie.startAngle(this.props.start_angle);
    }
    if (this.props.end_angle) {
      pie = pie.endAngle(this.props.end_angle);
    }
    arc = d3.arc().outerRadius(radius).innerRadius(inner_radius);
    arcs = pie(data).map(arc);
    return React.createElement("svg", {
      "className": 'pie-chart',
      "style": {
        position: 'relative',
        width: width,
        height: height
      }
    }, React.createElement("g", {
      "transform": "translate(" + radius + ", " + radius + ")"
    }, arcs.map((function(_this) {
      return function(arc, di) {
        var className, d;
        d = data[di];
        className = '';
        if (selected === d.label) {
          className += ' selected';
        } else if (hover === d.label) {
          className += ' hover';
        }
        return React.createElement("path", {
          "className": className,
          "onClick": onClick != null ? onClick.bind(null, d) : void 0,
          "onMouseOver": onHover != null ? onHover.bind(null, d) : void 0,
          "onMouseOut": onHover,
          "key": di,
          "x": radius,
          "y": radius,
          "d": arc,
          "fill": d.color || color(di)
        });
      };
    })(this))));
  }
});
